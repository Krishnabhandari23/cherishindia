# Render Deployment Guide - Full Stack Application

## ğŸ“‹ Overview
This guide helps you deploy both frontend (React) and backend (Node.js) as a single application on Render.

## ğŸš€ Deployment Configuration

### 1. Root Package.json Configuration
The root `package.json` includes these important scripts:
- **build**: Installs and builds both client and server
- **start**: Starts the Node.js server (which serves the built React app)
- **heroku-postbuild**: Legacy support for Heroku-style deployments

### 2. Render Configuration (render.yaml)
```yaml
services:
  - type: web
    name: cherish-india-fullstack
    env: node
    plan: free
    buildCommand: npm run build
    startCommand: npm start
    publishPath: ./client/dist
    staticPublishPath: ./client/dist
```

### 3. Server Configuration
The Node.js server now:
- Serves static files from `client/dist` in production
- Handles React routing with catch-all route
- Uses relative API URLs in production (`/api`)

## ğŸ”§ Build Process

### Local Testing
```bash
# Install dependencies for both frontend and backend
npm run build

# Start the production server locally
npm start
```

### What happens during build:
1. Installs client dependencies
2. Builds React app to `client/dist`
3. Installs server dependencies
4. Server serves built React files in production

## ğŸŒ Environment Variables on Render

Set these environment variables in your Render service:

### Required Variables:
- `NODE_ENV`: `production`
- `PORT`: `10000` (Render default)
- `MONGODB_URI`: Your MongoDB connection string
- `JWT_SECRET`: Auto-generated or custom secret

### Optional Variables:
- `CLIENT_URL`: Your app URL (auto-generated by Render)

## ğŸ“ Deployment Steps

### Step 1: Push to GitHub
```bash
git add .
git commit -m "Configure for Render deployment"
git push origin main
```

### Step 2: Create Render Service
1. Go to [Render Dashboard](https://dashboard.render.com)
2. Click "New +" â†’ "Web Service"
3. Connect your GitHub repository
4. Use these settings:
   - **Name**: `cherish-india-fullstack`
   - **Environment**: `Node`
   - **Build Command**: `npm run build`
   - **Start Command**: `npm start`
   - **Plan**: Free (or higher)

### Step 3: Configure Environment Variables
Add the required environment variables in Render dashboard.

### Step 4: Deploy
Render will automatically build and deploy your application.

## ğŸ” Verification

After deployment, your app will be available at:
- **URL**: `https://cherish-india-fullstack.onrender.com`
- **API**: `https://cherish-india-fullstack.onrender.com/api`
- **Health Check**: `https://cherish-india-fullstack.onrender.com/api/health`

## ğŸ› Troubleshooting

### Build Issues:
- Check build logs in Render dashboard
- Ensure all dependencies are in `package.json`
- Verify Node.js version compatibility

### Runtime Issues:
- Check application logs in Render
- Verify environment variables are set
- Test API endpoints manually

### Common Fixes:
```bash
# If build fails, try locally first:
npm run build
npm start

# Check for missing dependencies:
npm install
```

## ğŸ“ File Structure After Deployment
```
/
â”œâ”€â”€ package.json (root - for deployment)
â”œâ”€â”€ render.yaml (Render configuration)
â”œâ”€â”€ client/
â”‚   â”œâ”€â”€ dist/ (built React app - served by Express)
â”‚   â””â”€â”€ package.json
â””â”€â”€ server/
    â”œâ”€â”€ server.js (serves API + static files)
    â””â”€â”€ package.json
```

## ğŸ¯ Key Benefits of This Setup

1. **Single Domain**: Frontend and backend on same domain (no CORS issues)
2. **Cost Effective**: Only one Render service needed
3. **Simplified Deployment**: One command deploys everything
4. **React Routing**: Server handles React router properly
5. **Production Optimized**: Serves optimized static files

## ğŸ”„ Updates and Redeployments

To update your application:
```bash
# Make your changes
git add .
git commit -m "Your changes"
git push origin main
```

Render will automatically rebuild and redeploy your application.

---

**Note**: First deployment may take 5-10 minutes. Subsequent deployments are usually faster.